{"version":3,"file":"BareClient.umd.cjs","sources":["../src/snapshot.ts","../src/Client.ts","../src/encodeProtocol.ts","../src/V1.ts","../src/md5.ts","../src/splitHeaderUtil.ts","../src/V2.ts","../src/BareClient.ts"],"sourcesContent":["// The user likely has overwritten all networking functions after importing bare-client\n// It is our responsibility to make sure components of Bare-Client are using native networking functions\n\n// These exports are provided to plugins by @rollup/plugin-inject\n\nexport const global = globalThis;\nexport const fetch = global.fetch;\nexport const WebSocket = global.WebSocket;\nexport const Request = global.Request;\nexport const Response = global.Response;\nexport const XMLHttpRequest = global.XMLHttpRequest;\n","import {\n\tBareBodyInit,\n\tBareCache,\n\tBareHeaders,\n\tBareHTTPProtocol,\n\tBareMethod,\n\tBareResponse,\n\tBareWebSocket,\n\tBareWSProtocol,\n} from './BareClient';\n\nexport const statusEmpty = [101, 204, 205, 304];\nexport const statusRedirect = [301, 302, 303, 307, 308];\n\nexport interface BareErrorBody {\n\tcode: string;\n\tid: string;\n\tmessage?: string;\n\tstack?: string;\n}\n\nexport class BareError extends Error {\n\tstatus: number;\n\tbody: BareErrorBody;\n\tconstructor(status: number, body: BareErrorBody) {\n\t\tsuper(body.message || body.code);\n\t\tthis.status = status;\n\t\tthis.body = body;\n\t}\n}\n\nexport interface GenericClient {\n\tconnect(\n\t\trequestHeaders: BareHeaders,\n\t\tprotocol: BareWSProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string\n\t): Promise<BareWebSocket>;\n\trequest(\n\t\tmethod: BareMethod,\n\t\trequestHeaders: BareHeaders,\n\t\tbody: BareBodyInit,\n\t\tprotocol: BareHTTPProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string,\n\t\tcache: BareCache | undefined,\n\t\tsignal: AbortSignal | undefined\n\t): Promise<BareResponse>;\n}\n\nexport default class Client {\n\tprotected base: URL;\n\t/**\n\t *\n\t * @param version Version provided by extension\n\t * @param server Bare Server URL provided by BareClient\n\t */\n\tconstructor(version: number, server: URL) {\n\t\tthis.base = new URL(`./v${version}/`, server);\n\t}\n}\n","const validChars =\n\t\"!#$%&'*+-.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ^_`abcdefghijklmnopqrstuvwxyz|~\";\nconst reserveChar = '%';\n\nexport function validProtocol(protocol: string): boolean {\n\tfor (let i = 0; i < protocol.length; i++) {\n\t\tconst char = protocol[i];\n\n\t\tif (!validChars.includes(char)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport function encodeProtocol(protocol: string): string {\n\tlet result = '';\n\n\tfor (let i = 0; i < protocol.length; i++) {\n\t\tconst char = protocol[i];\n\n\t\tif (validChars.includes(char) && char !== reserveChar) {\n\t\t\tresult += char;\n\t\t} else {\n\t\t\tconst code = char.charCodeAt(0);\n\t\t\tresult += reserveChar + code.toString(16).padStart(2, '0');\n\t\t}\n\t}\n\n\treturn result;\n}\n\nexport function decodeProtocol(protocol: string): string {\n\tlet result = '';\n\n\tfor (let i = 0; i < protocol.length; i++) {\n\t\tconst char = protocol[i];\n\n\t\tif (char === reserveChar) {\n\t\t\tconst code = parseInt(protocol.slice(i + 1, i + 3), 16);\n\t\t\tconst decoded = String.fromCharCode(code);\n\n\t\t\tresult += decoded;\n\t\t\ti += 2;\n\t\t} else {\n\t\t\tresult += char;\n\t\t}\n\t}\n\n\treturn result;\n}\n","import {\n\tBareBodyInit,\n\tBareCache,\n\tBareHeaders,\n\tBareHTTPProtocol,\n\tBareMethod,\n\tBareResponse,\n\tBareWebSocket,\n\tBareWSProtocol,\n\tXBare,\n} from './BareClient.js';\nimport Client, { BareError, GenericClient, statusEmpty } from './Client.js';\nimport { encodeProtocol } from './encodeProtocol.js';\n\nexport default class ClientV1 extends Client implements GenericClient {\n\tws: URL;\n\thttp: URL;\n\tnewMeta: URL;\n\tgetMeta: URL;\n\tconstructor(server: URL) {\n\t\tsuper(1, server);\n\n\t\tthis.ws = new URL(this.base);\n\t\tthis.http = new URL(this.base);\n\t\tthis.newMeta = new URL('ws-new-meta', this.base);\n\t\tthis.getMeta = new URL('ws-meta', this.base);\n\n\t\tif (this.ws.protocol === 'https:') {\n\t\t\tthis.ws.protocol = 'wss:';\n\t\t} else {\n\t\t\tthis.ws.protocol = 'ws:';\n\t\t}\n\t}\n\tasync connect(\n\t\trequestHeaders: BareHeaders,\n\t\tprotocol: BareWSProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string\n\t): Promise<BareWebSocket> {\n\t\tconst assignMeta = await fetch(this.newMeta, { method: 'GET' });\n\n\t\tif (!assignMeta.ok) {\n\t\t\tthrow new BareError(assignMeta.status, await assignMeta.json());\n\t\t}\n\n\t\tconst id = await assignMeta.text();\n\n\t\tconst socket: WebSocket & Partial<BareWebSocket> = new WebSocket(this.ws, [\n\t\t\t'bare',\n\t\t\tencodeProtocol(\n\t\t\t\tJSON.stringify({\n\t\t\t\t\tremote: {\n\t\t\t\t\t\tprotocol,\n\t\t\t\t\t\thost,\n\t\t\t\t\t\tport,\n\t\t\t\t\t\tpath,\n\t\t\t\t\t},\n\t\t\t\t\theaders: requestHeaders,\n\t\t\t\t\tforward_headers: [\n\t\t\t\t\t\t'accept-encoding',\n\t\t\t\t\t\t'accept-language',\n\t\t\t\t\t\t'sec-websocket-extensions',\n\t\t\t\t\t\t'sec-websocket-key',\n\t\t\t\t\t\t'sec-websocket-version',\n\t\t\t\t\t],\n\t\t\t\t\tid,\n\t\t\t\t})\n\t\t\t),\n\t\t]);\n\n\t\tsocket.meta = new Promise<XBare>((resolve, reject) => {\n\t\t\tsocket.addEventListener('open', async () => {\n\t\t\t\tconst outgoing = await fetch(this.getMeta, {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'x-bare-id': id,\n\t\t\t\t\t},\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t});\n\n\t\t\t\tif (!outgoing.ok) {\n\t\t\t\t\treject(new BareError(outgoing.status, await outgoing.json()));\n\t\t\t\t}\n\n\t\t\t\tresolve(await outgoing.json());\n\t\t\t});\n\n\t\t\tsocket.addEventListener('error', reject);\n\t\t});\n\n\t\treturn <BareWebSocket>socket;\n\t}\n\tasync request(\n\t\tmethod: BareMethod,\n\t\trequestHeaders: BareHeaders,\n\t\tbody: BareBodyInit,\n\t\tprotocol: BareHTTPProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string,\n\t\tcache: BareCache | undefined,\n\t\tsignal: AbortSignal | undefined\n\t): Promise<BareResponse> {\n\t\tif (protocol.startsWith('blob:')) {\n\t\t\tconst response = await fetch(`blob:${location.origin}${path}`);\n\t\t\tconst result: Response & Partial<BareResponse> = new Response(\n\t\t\t\tresponse.body,\n\t\t\t\tresponse\n\t\t\t);\n\n\t\t\tresult.rawHeaders = Object.fromEntries(response.headers);\n\t\t\tresult.rawResponse = response;\n\n\t\t\treturn <BareResponse>result;\n\t\t}\n\n\t\tconst bareHeaders: BareHeaders = {};\n\n\t\tif (requestHeaders instanceof Headers) {\n\t\t\tfor (const [header, value] of requestHeaders) {\n\t\t\t\tbareHeaders[header] = value;\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const header in requestHeaders) {\n\t\t\t\tbareHeaders[header] = requestHeaders[header];\n\t\t\t}\n\t\t}\n\n\t\tconst forwardHeaders = ['accept-encoding', 'accept-language'];\n\n\t\tconst options: RequestInit = {\n\t\t\tcredentials: 'omit',\n\t\t\tmethod: method,\n\t\t\tsignal,\n\t\t};\n\n\t\tif (body !== undefined) {\n\t\t\toptions.body = body;\n\t\t}\n\n\t\t// bare can be an absolute path containing no origin, it becomes relative to the script\n\t\tconst request = new Request(this.http, options);\n\n\t\tthis.writeBareRequest(\n\t\t\trequest,\n\t\t\tprotocol,\n\t\t\thost,\n\t\t\tpath,\n\t\t\tport,\n\t\t\tbareHeaders,\n\t\t\tforwardHeaders\n\t\t);\n\n\t\tconst response = await fetch(request);\n\n\t\tconst readResponse = await this.readBareResponse(response);\n\n\t\tconst result: Partial<BareResponse> = new Response(\n\t\t\tstatusEmpty.includes(readResponse.status) ? undefined : response.body,\n\t\t\t{\n\t\t\t\tstatus: readResponse.status,\n\t\t\t\tstatusText: readResponse.statusText ?? undefined,\n\t\t\t\theaders: readResponse.headers,\n\t\t\t}\n\t\t);\n\n\t\tresult.rawHeaders = readResponse.rawHeaders;\n\t\tresult.rawResponse = response;\n\n\t\treturn <BareResponse>result;\n\t}\n\tprivate async readBareResponse(response: Response) {\n\t\tif (!response.ok) {\n\t\t\tthrow new BareError(response.status, await response.json());\n\t\t}\n\n\t\tconst requiredHeaders = [\n\t\t\t'x-bare-status',\n\t\t\t'x-bare-status-text',\n\t\t\t'x-bare-headers',\n\t\t];\n\n\t\tfor (const header of requiredHeaders) {\n\t\t\tif (!response.headers.has(header)) {\n\t\t\t\tthrow new BareError(500, {\n\t\t\t\t\tcode: 'IMPL_MISSING_BARE_HEADER',\n\t\t\t\t\tid: `response.headers.${header}`,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst status = parseInt(response.headers.get('x-bare-status')!);\n\t\tconst statusText = response.headers.get('x-bare-status-text')!;\n\t\tconst rawHeaders = JSON.parse(response.headers.get('x-bare-headers')!);\n\t\tconst headers = new Headers(rawHeaders);\n\n\t\treturn {\n\t\t\tstatus,\n\t\t\tstatusText,\n\t\t\trawHeaders,\n\t\t\theaders,\n\t\t};\n\t}\n\tprivate writeBareRequest(\n\t\trequest: Request,\n\t\tprotocol: BareHTTPProtocol,\n\t\thost: string,\n\t\tpath: string,\n\t\tport: string | number,\n\t\tbareHeaders: BareHeaders,\n\t\tforwardHeaders: string[]\n\t) {\n\t\trequest.headers.set('x-bare-protocol', protocol);\n\t\trequest.headers.set('x-bare-host', host);\n\t\trequest.headers.set('x-bare-path', path);\n\t\trequest.headers.set('x-bare-port', port.toString());\n\t\trequest.headers.set('x-bare-headers', JSON.stringify(bareHeaders));\n\t\trequest.headers.set(\n\t\t\t'x-bare-forward-headers',\n\t\t\tJSON.stringify(forwardHeaders)\n\t\t);\n\t}\n}\n","/*\n * JavaScript MD5\n * Adopted from https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\n\n/**\n * Add integers, wrapping at 2^32.\n * This uses 16-bit operations internally to work around bugs in interpreters.\n *\n * @param x First integer\n * @param y Second integer\n * @returns Sum\n */\nfunction safeAdd(x: number, y: number): number {\n\tconst lsw = (x & 0xffff) + (y & 0xffff);\n\tconst msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n\treturn (msw << 16) | (lsw & 0xffff);\n}\n\n/**\n * Bitwise rotate a 32-bit number to the left.\n *\n * @param num 32-bit number\n * @param cnt Rotation count\n * @returns  Rotated number\n */\nfunction bitRotateLeft(num: number, cnt: number): number {\n\treturn (num << cnt) | (num >>> (32 - cnt));\n}\n\n/**\n * Basic operation the algorithm uses.\n *\n * @param q q\n * @param a a\n * @param b b\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5cmn(\n\tq: number,\n\ta: number,\n\tb: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5ff(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn((b & c) | (~b & d), a, b, x, s, t);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5gg(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn((b & d) | (c & ~d), a, b, x, s, t);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5hh(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5ii(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\n/**\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n *\n * @param x Array of little-endian words\n * @param len Bit length\n * @returns MD5 Array\n */\nfunction binlMD5(x: number[], len: number): number[] {\n\t/* append padding */\n\tx[len >> 5] |= 0x80 << len % 32;\n\tx[(((len + 64) >>> 9) << 4) + 14] = len;\n\n\tlet a = 1732584193;\n\tlet b = -271733879;\n\tlet c = -1732584194;\n\tlet d = 271733878;\n\n\tfor (let i = 0; i < x.length; i += 16) {\n\t\tconst olda = a;\n\t\tconst oldb = b;\n\t\tconst oldc = c;\n\t\tconst oldd = d;\n\n\t\ta = md5ff(a, b, c, d, x[i], 7, -680876936);\n\t\td = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n\t\tc = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n\t\tb = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n\t\ta = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n\t\td = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n\t\tc = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n\t\tb = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n\t\ta = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n\t\td = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n\t\tc = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n\t\tb = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n\t\ta = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n\t\td = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n\t\tc = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n\t\tb = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n\n\t\ta = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n\t\td = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n\t\tc = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n\t\tb = md5gg(b, c, d, a, x[i], 20, -373897302);\n\t\ta = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n\t\td = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n\t\tc = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n\t\tb = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n\t\ta = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n\t\td = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n\t\tc = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n\t\tb = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n\t\ta = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n\t\td = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n\t\tc = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n\t\tb = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n\n\t\ta = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n\t\td = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n\t\tc = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n\t\tb = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n\t\ta = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n\t\td = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n\t\tc = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n\t\tb = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n\t\ta = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n\t\td = md5hh(d, a, b, c, x[i], 11, -358537222);\n\t\tc = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n\t\tb = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n\t\ta = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n\t\td = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n\t\tc = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n\t\tb = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n\n\t\ta = md5ii(a, b, c, d, x[i], 6, -198630844);\n\t\td = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n\t\tc = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n\t\tb = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n\t\ta = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n\t\td = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n\t\tc = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n\t\tb = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n\t\ta = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n\t\td = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n\t\tc = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n\t\tb = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n\t\ta = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n\t\td = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n\t\tc = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n\t\tb = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n\n\t\ta = safeAdd(a, olda);\n\t\tb = safeAdd(b, oldb);\n\t\tc = safeAdd(c, oldc);\n\t\td = safeAdd(d, oldd);\n\t}\n\treturn [a, b, c, d];\n}\n\n/**\n * Convert an array of little-endian words to a string\n *\n * @param input MD5 Array\n * @returns MD5 string\n */\nfunction binl2rstr(input: number[]): string {\n\tlet output = '';\n\tconst length32 = input.length * 32;\n\tfor (let i = 0; i < length32; i += 8) {\n\t\toutput += String.fromCharCode((input[i >> 5] >>> i % 32) & 0xff);\n\t}\n\treturn output;\n}\n\n/**\n * Convert a raw string to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n *\n * @param input Raw input string\n * @returns Array of little-endian words\n */\nfunction rstr2binl(input: string): number[] {\n\tconst output: number[] = [];\n\tconst outputLen = input.length >> 2;\n\tfor (let i = 0; i < outputLen; i += 1) {\n\t\toutput[i] = 0;\n\t}\n\tconst length8 = input.length * 8;\n\tfor (let i = 0; i < length8; i += 8) {\n\t\toutput[i >> 5]! |= (input.charCodeAt(i / 8) & 0xff) << i % 32;\n\t}\n\treturn <number[]>output;\n}\n\n/**\n * Calculate the MD5 of a raw string\n *\n * @param s Input string\n * @returns Raw MD5 string\n */\nfunction rstrMD5(s: string): string {\n\treturn binl2rstr(binlMD5(rstr2binl(s), s.length * 8));\n}\n\n/**\n * Calculates the HMAC-MD5 of a key and some data (raw strings)\n *\n * @param key HMAC key\n * @param data Raw input string\n * @returns Raw MD5 string\n */\nfunction rstrHMACMD5(key: string, data: string): string {\n\tlet bkey = rstr2binl(key);\n\tconst ipad: number[] = [];\n\tconst opad: number[] = [];\n\tif (bkey.length > 16) {\n\t\tbkey = binlMD5(bkey, key.length * 8);\n\t}\n\tfor (let i = 0; i < 16; i += 1) {\n\t\tipad[i] = bkey[i] ^ 0x36363636;\n\t\topad[i] = bkey[i] ^ 0x5c5c5c5c;\n\t}\n\tconst hash = binlMD5(ipad.concat(rstr2binl(data)), 512 + data.length * 8);\n\treturn binl2rstr(binlMD5(opad.concat(hash), 512 + 128));\n}\n\n/**\n * Convert a raw string to a hex string\n *\n * @param input Raw input string\n * @returns Hex encoded string\n */\nfunction rstr2hex(input: string): string {\n\tconst hexTab = '0123456789abcdef';\n\tlet output = '';\n\tfor (let i = 0; i < input.length; i += 1) {\n\t\tconst x = input.charCodeAt(i);\n\t\toutput += hexTab.charAt((x >>> 4) & 0x0f) + hexTab.charAt(x & 0x0f);\n\t}\n\treturn output;\n}\n\n/**\n * Encode a string as UTF-8\n *\n * @param input Input string\n * @returns UTF8 string\n */\nfunction str2rstrUTF8(input: string): string {\n\treturn unescape(encodeURIComponent(input));\n}\n\n/**\n * Encodes input string as raw MD5 string\n *\n * @param s Input string\n * @returns Raw MD5 string\n */\nfunction rawMD5(s: string): string {\n\treturn rstrMD5(str2rstrUTF8(s));\n}\n/**\n * Encodes input string as Hex encoded string\n *\n * @param s Input string\n * @returns Hex encoded string\n */\nfunction hexMD5(s: string): string {\n\treturn rstr2hex(rawMD5(s));\n}\n/**\n * Calculates the raw HMAC-MD5 for the given key and data\n *\n * @param k HMAC key\n * @param d Input string\n * @returns Raw MD5 string\n */\nfunction rawHMACMD5(k: string, d: string): string {\n\treturn rstrHMACMD5(str2rstrUTF8(k), str2rstrUTF8(d));\n}\n/**\n * Calculates the Hex encoded HMAC-MD5 for the given key and data\n *\n * @param k HMAC key\n * @param d Input string\n * @returns Raw MD5 string\n */\nfunction hexHMACMD5(k: string, d: string): string {\n\treturn rstr2hex(rawHMACMD5(k, d));\n}\n\n/**\n * Calculates MD5 value for a given string.\n * If a key is provided, calculates the HMAC-MD5 value.\n * Returns a Hex encoded string unless the raw argument is given.\n *\n * @param string Input string\n * @param key HMAC key\n * @param raw Raw output switch\n * @returns MD5 output\n */\nexport default function md5(\n\tstring: string,\n\tkey?: string,\n\traw?: boolean\n): string {\n\tif (!key) {\n\t\tif (!raw) {\n\t\t\treturn hexMD5(string);\n\t\t}\n\t\treturn rawMD5(string);\n\t}\n\tif (!raw) {\n\t\treturn hexHMACMD5(key, string);\n\t}\n\treturn rawHMACMD5(key, string);\n}\n","import { BareError } from './Client';\n\nconst MAX_HEADER_VALUE = 3072;\n\n/**\n *\n * Splits headers according to spec\n * @param headers\n * @returns Split headers\n */\nexport function splitHeaders(headers: Readonly<Headers>): Headers {\n\tconst output = new Headers(headers);\n\n\tif (headers.has('x-bare-headers')) {\n\t\tconst value = headers.get('x-bare-headers')!;\n\n\t\tif (value.length > MAX_HEADER_VALUE) {\n\t\t\toutput.delete('x-bare-headers');\n\n\t\t\tlet split = 0;\n\n\t\t\tfor (let i = 0; i < value.length; i += MAX_HEADER_VALUE) {\n\t\t\t\tconst part = value.slice(i, i + MAX_HEADER_VALUE);\n\n\t\t\t\tconst id = split++;\n\t\t\t\toutput.set(`x-bare-headers-${id}`, `;${part}`);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn output;\n}\n\n/**\n * Joins headers according to spec\n * @param headers\n * @returns Joined headers\n */\nexport function joinHeaders(headers: Readonly<Headers>): Headers {\n\tconst output = new Headers(headers);\n\n\tconst prefix = 'x-bare-headers';\n\n\tif (headers.has(`${prefix}-0`)) {\n\t\tconst join = [];\n\n\t\tfor (const [header, value] of headers) {\n\t\t\tif (!header.startsWith(prefix)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!value.startsWith(';')) {\n\t\t\t\tthrow new BareError(400, {\n\t\t\t\t\tcode: 'INVALID_BARE_HEADER',\n\t\t\t\t\tid: `request.headers.${header}`,\n\t\t\t\t\tmessage: `Value didn't begin with semi-colon.`,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst id = parseInt(header.slice(prefix.length + 1));\n\n\t\t\tjoin[id] = value.slice(1);\n\n\t\t\toutput.delete(header);\n\t\t}\n\n\t\toutput.set(prefix, join.join(''));\n\t}\n\n\treturn output;\n}\n","import {\n\tBareBodyInit,\n\tBareCache,\n\tBareHeaders,\n\tBareHTTPProtocol,\n\tBareMethod,\n\tBareResponse,\n\tBareWebSocket,\n\tBareWSProtocol,\n\tXBare,\n} from './BareClient';\nimport Client, { BareError, GenericClient, statusEmpty } from './Client';\nimport md5 from './md5';\nimport { joinHeaders, splitHeaders } from './splitHeaderUtil';\n\nexport default class ClientV2 extends Client implements GenericClient {\n\tws: URL;\n\thttp: URL;\n\tnewMeta: URL;\n\tgetMeta: URL;\n\tconstructor(server: URL) {\n\t\tsuper(2, server);\n\n\t\tthis.ws = new URL(this.base);\n\t\tthis.http = new URL(this.base);\n\t\tthis.newMeta = new URL('./ws-new-meta', this.base);\n\t\tthis.getMeta = new URL(`./ws-meta`, this.base);\n\n\t\tif (this.ws.protocol === 'https:') {\n\t\t\tthis.ws.protocol = 'wss:';\n\t\t} else {\n\t\t\tthis.ws.protocol = 'ws:';\n\t\t}\n\t}\n\tasync connect(\n\t\trequestHeaders: BareHeaders,\n\t\tprotocol: BareWSProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string\n\t): Promise<BareWebSocket> {\n\t\tconst request = new Request(this.newMeta, {\n\t\t\theaders: this.createBareHeaders(\n\t\t\t\tprotocol,\n\t\t\t\thost,\n\t\t\t\tpath,\n\t\t\t\tport,\n\t\t\t\trequestHeaders\n\t\t\t),\n\t\t});\n\n\t\tconst assign_meta = await fetch(request);\n\n\t\tif (!assign_meta.ok) {\n\t\t\tthrow new BareError(assign_meta.status, await assign_meta.json());\n\t\t}\n\n\t\tconst id = await assign_meta.text();\n\n\t\tconst socket: WebSocket & Partial<BareWebSocket> = new WebSocket(this.ws, [\n\t\t\tid,\n\t\t]);\n\n\t\tsocket.meta = new Promise<XBare>((resolve, reject) => {\n\t\t\tsocket.addEventListener('open', async () => {\n\t\t\t\tconst outgoing = await fetch(this.getMeta, {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'x-bare-id': id,\n\t\t\t\t\t},\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t});\n\n\t\t\t\tresolve(await await this.readBareResponse(outgoing));\n\t\t\t});\n\n\t\t\tsocket.addEventListener('error', reject);\n\t\t});\n\n\t\treturn <BareWebSocket>socket;\n\t}\n\tasync request(\n\t\tmethod: BareMethod,\n\t\trequestHeaders: BareHeaders,\n\t\tbody: BareBodyInit,\n\t\tprotocol: BareHTTPProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string,\n\t\tcache: BareCache | undefined,\n\t\tsignal: AbortSignal | undefined\n\t): Promise<BareResponse> {\n\t\tif (protocol.startsWith('blob:')) {\n\t\t\tconst response = await fetch(`blob:${location.origin}${path}`);\n\t\t\tconst result: Response & Partial<BareResponse> = new Response(\n\t\t\t\tresponse.body,\n\t\t\t\tresponse\n\t\t\t);\n\n\t\t\tresult.rawHeaders = Object.fromEntries(response.headers);\n\t\t\tresult.rawResponse = response;\n\n\t\t\treturn <BareResponse>result;\n\t\t}\n\n\t\tconst bareHeaders: BareHeaders = {};\n\n\t\tif (requestHeaders instanceof Headers) {\n\t\t\tfor (const [header, value] of requestHeaders) {\n\t\t\t\tbareHeaders[header] = value;\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const header in requestHeaders) {\n\t\t\t\tbareHeaders[header] = requestHeaders[header];\n\t\t\t}\n\t\t}\n\n\t\tconst options: RequestInit = {\n\t\t\tcredentials: 'omit',\n\t\t\tmethod: method,\n\t\t\tsignal,\n\t\t};\n\n\t\tif (cache !== 'only-if-cached') {\n\t\t\toptions.cache = <RequestCache>cache;\n\t\t}\n\n\t\tif (body !== undefined) {\n\t\t\toptions.body = body;\n\t\t}\n\n\t\toptions.headers = this.createBareHeaders(\n\t\t\tprotocol,\n\t\t\thost,\n\t\t\tpath,\n\t\t\tport,\n\t\t\tbareHeaders\n\t\t);\n\n\t\tconst request = new Request(\n\t\t\tthis.http + '?cache=' + md5(`${protocol}${host}${port}${path}`),\n\t\t\toptions\n\t\t);\n\n\t\tconst response = await fetch(request);\n\n\t\tconst readResponse = await this.readBareResponse(response);\n\n\t\tconst result: Response & Partial<BareResponse> = new Response(\n\t\t\tstatusEmpty.includes(readResponse.status!) ? undefined : response.body,\n\t\t\t{\n\t\t\t\tstatus: readResponse.status!,\n\t\t\t\tstatusText: readResponse.statusText ?? undefined,\n\t\t\t\theaders: readResponse.headers!,\n\t\t\t}\n\t\t);\n\n\t\tresult.rawHeaders = readResponse.rawHeaders;\n\t\tresult.rawResponse = response;\n\n\t\treturn <BareResponse>result;\n\t}\n\tprivate async readBareResponse(response: Response): Promise<XBare> {\n\t\tif (!response.ok) {\n\t\t\tthrow new BareError(response.status, await response.json());\n\t\t}\n\n\t\tconst responseHeaders = joinHeaders(response.headers);\n\n\t\tconst result: XBare = {};\n\n\t\tif (responseHeaders.has('x-bare-status')) {\n\t\t\tresult.status = parseInt(responseHeaders.get('x-bare-status')!);\n\t\t}\n\n\t\tif (responseHeaders.has('x-bare-status-text')) {\n\t\t\tresult.statusText = responseHeaders.get('x-bare-status-text')!;\n\t\t}\n\n\t\tif (responseHeaders.has('x-bare-headers')) {\n\t\t\tresult.rawHeaders = JSON.parse(responseHeaders.get('x-bare-headers')!);\n\t\t\tresult.headers = new Headers(<HeadersInit>result.rawHeaders);\n\t\t}\n\n\t\treturn result;\n\t}\n\tcreateBareHeaders(\n\t\tprotocol: BareWSProtocol | BareHTTPProtocol,\n\t\thost: string,\n\t\tpath: string,\n\t\tport: number | string,\n\t\tbareHeaders: BareHeaders,\n\t\tforwardHeaders: string[] = [],\n\t\tpassHeaders: string[] = [],\n\t\tpassStatus: number[] = []\n\t) {\n\t\tconst headers = new Headers();\n\n\t\theaders.set('x-bare-protocol', protocol);\n\t\theaders.set('x-bare-host', host);\n\t\theaders.set('x-bare-path', path);\n\t\theaders.set('x-bare-port', port.toString());\n\t\theaders.set('x-bare-headers', JSON.stringify(bareHeaders));\n\n\t\tfor (const header of forwardHeaders) {\n\t\t\theaders.append('x-bare-forward-headers', header);\n\t\t}\n\n\t\tfor (const header of passHeaders) {\n\t\t\theaders.append('x-bare-pass-headers', header);\n\t\t}\n\n\t\tfor (const status of passStatus) {\n\t\t\theaders.append('x-bare-pass-status', status.toString());\n\t\t}\n\n\t\tsplitHeaders(headers);\n\n\t\treturn headers;\n\t}\n}\n","import { GenericClient, statusRedirect } from './Client';\nimport ClientV1 from './V1';\nimport ClientV2 from './V2';\nimport { validProtocol } from './encodeProtocol';\n\n// Implements the protocol for requesting bare data from a server\n// See ../Server/Send.mjs\n\nexport * from './Client';\n\nconst clientCtors: [string, { new (server: URL): GenericClient }][] = [\n\t['v2', ClientV2],\n\t['v1', ClientV1],\n];\n\nexport type BareMethod =\n\t| 'GET'\n\t| 'POST'\n\t| 'DELETE'\n\t| 'OPTIONS'\n\t| 'PUT'\n\t| 'PATCH'\n\t| 'UPDATE'\n\t| string;\n\nexport type BareCache =\n\t| 'default'\n\t| 'no-store'\n\t| 'reload'\n\t| 'no-cache'\n\t| 'force-cache'\n\t| 'only-if-cached'\n\t| string;\n\nexport interface XBare {\n\tstatus?: number;\n\tstatusText?: string;\n\theaders?: Headers;\n\trawHeaders?: BareHeaders;\n}\n\nexport type BareHTTPProtocol = 'blob:' | 'http:' | 'https:' | string;\nexport type BareWSProtocol = 'ws:' | 'wss:' | string;\n\nexport type urlLike = URL | string;\n\nexport const maxRedirects = 20;\n\nexport type BareHeaders = { [key: string]: string | string[] };\n\n/**\n * WebSocket with an additional property.\n */\nexport type BareWebSocket = WebSocket & { meta: Promise<XBare> };\n\n/**\n * A Response with additional properties.\n */\nexport type BareResponse = Response & {\n\trawResponse: Response;\n\trawHeaders: BareHeaders;\n};\n\n/**\n * A BareResponse with additional properties.\n */\nexport type BareResponseFetch = BareResponse & { finalURL: string };\nexport type BareBodyInit =\n\t| Blob\n\t| BufferSource\n\t| FormData\n\t| URLSearchParams\n\t| ReadableStream\n\t| undefined\n\t| null;\n\nexport type BareFetchInit = {\n\tmethod?: BareMethod;\n\theaders?: Headers | BareHeaders;\n\tbody?: BareBodyInit;\n\tcache?: BareCache;\n\tredirect?: 'follow' | 'manual' | 'error' | string;\n\tsignal?: AbortSignal;\n};\n\nexport type BareMaintainer = {\n\temail?: string;\n\twebsite?: string;\n};\n\nexport type BareProject = {\n\tname?: string;\n\tdescription?: string;\n\temail?: string;\n\twebsite?: string;\n\trepository?: string;\n};\n\nexport type BareLanguage =\n\t| 'NodeJS'\n\t| 'Deno'\n\t| 'Java'\n\t| 'PHP'\n\t| 'Rust'\n\t| 'C'\n\t| 'C++'\n\t| 'C#'\n\t| 'Ruby'\n\t| 'Go'\n\t| 'Crystal'\n\t| 'Bash'\n\t| string;\n\nexport type BareManifest = {\n\tmaintainer?: BareMaintainer;\n\tproject?: BareProject;\n\tversions: string[];\n\tlanguage: BareLanguage;\n\tmemoryUsage?: number;\n};\n\nexport default class BareClient {\n\tdata: BareManifest | undefined;\n\tprivate client: GenericClient | undefined;\n\tprivate server: URL;\n\tprivate ready: boolean;\n\t/**\n\t *\n\t * @param server A full URL to the bare server.\n\t * @param data The a copy of the Bare server data found in BareClient.data. If specified, this data will be loaded. Otherwise, a request will be made to the bare server (upon fetching or creating a WebSocket).\n\t */\n\tconstructor(server: string | URL, data?: BareManifest) {\n\t\tthis.server = new URL(server);\n\t\tthis.ready = false;\n\n\t\tif (typeof data === 'object') {\n\t\t\tthis.loadData(data);\n\t\t}\n\t}\n\tprivate loadData(data: BareManifest) {\n\t\tlet found = false;\n\n\t\t// newest-oldest\n\t\tfor (const [version, ctor] of clientCtors) {\n\t\t\tif (data.versions.includes(version)) {\n\t\t\t\tthis.client = new ctor(this.server);\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!found) {\n\t\t\tthrow new Error(`Unable to find compatible client version.`);\n\t\t}\n\n\t\tthis.data = data;\n\t\tthis.ready = true;\n\t}\n\tprivate async work() {\n\t\tif (this.ready === true) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst outgoing = await fetch(this.server);\n\n\t\tif (!outgoing.ok) {\n\t\t\tthrow new Error(\n\t\t\t\t`Unable to fetch Bare meta: ${outgoing.status} ${await outgoing.text()}`\n\t\t\t);\n\t\t}\n\n\t\tthis.loadData(await outgoing.json());\n\t}\n\tasync request(\n\t\tmethod: BareMethod,\n\t\trequestHeaders: BareHeaders,\n\t\tbody: BareBodyInit,\n\t\tprotocol: BareHTTPProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string,\n\t\tcache: BareCache | undefined,\n\t\tsignal: AbortSignal | undefined\n\t): Promise<BareResponse> {\n\t\tawait this.work();\n\t\treturn await this.client!.request(\n\t\t\tmethod,\n\t\t\trequestHeaders,\n\t\t\tbody,\n\t\t\tprotocol,\n\t\t\thost,\n\t\t\tport,\n\t\t\tpath,\n\t\t\tcache,\n\t\t\tsignal\n\t\t);\n\t}\n\tasync connect(\n\t\trequestHeaders: BareHeaders,\n\t\tprotocol: BareWSProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string\n\t): Promise<BareWebSocket> {\n\t\tawait this.work();\n\t\treturn this.client!.connect(requestHeaders, protocol, host, port, path);\n\t}\n\t/**\n\t *\n\t * @param url\n\t * @param protocols\n\t * @param origin Location of client that created the WebSocket\n\t * @returns\n\t */\n\tasync createWebSocket(\n\t\turl: urlLike,\n\t\theaders: BareHeaders = {},\n\t\tprotocols: string | string[] = []\n\t): Promise<BareWebSocket> {\n\t\tconst requestHeaders: BareHeaders =\n\t\t\theaders instanceof Headers ? Object.fromEntries(headers) : headers;\n\n\t\turl = new URL(url);\n\n\t\t// user is expected to specify user-agent and origin\n\t\t// both are in spec\n\n\t\trequestHeaders['Host'] = url.host;\n\t\t// requestHeaders['Origin'] = origin;\n\t\trequestHeaders['Pragma'] = 'no-cache';\n\t\trequestHeaders['Cache-Control'] = 'no-cache';\n\t\trequestHeaders['Upgrade'] = 'websocket';\n\t\t// requestHeaders['User-Agent'] = navigator.userAgent;\n\t\trequestHeaders['Connection'] = 'Upgrade';\n\n\t\tif (typeof protocols === 'string') {\n\t\t\tprotocols = [protocols];\n\t\t}\n\n\t\tfor (const proto of protocols) {\n\t\t\tif (!validProtocol(proto)) {\n\t\t\t\tthrow new DOMException(\n\t\t\t\t\t`Failed to construct 'WebSocket': The subprotocol '${proto}' is invalid.`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (protocols.length) {\n\t\t\theaders['Sec-Websocket-Protocol'] = protocols.join(', ');\n\t\t}\n\n\t\tawait this.work();\n\t\treturn this.client!.connect(\n\t\t\theaders,\n\t\t\turl.protocol,\n\t\t\turl.hostname,\n\t\t\turl.port,\n\t\t\turl.pathname + url.search\n\t\t);\n\t}\n\tasync fetch(\n\t\turl: urlLike | Request,\n\t\tinit: BareFetchInit = {}\n\t): Promise<BareResponseFetch> {\n\t\tif (url instanceof Request) {\n\t\t\t// behave similar to the browser when fetch is called with (Request, Init)\n\t\t\tif (init) {\n\t\t\t\turl = new URL(url.url);\n\t\t\t} else {\n\t\t\t\tinit = url;\n\t\t\t\turl = new URL(url.url);\n\t\t\t}\n\t\t} else {\n\t\t\turl = new URL(url);\n\t\t}\n\n\t\tlet method: BareMethod;\n\n\t\tif (typeof init.method === 'string') {\n\t\t\tmethod = init.method;\n\t\t} else {\n\t\t\tmethod = 'GET';\n\t\t}\n\n\t\tlet body: BareBodyInit;\n\n\t\tif (init.body !== undefined && init.body !== null) {\n\t\t\tbody = init.body;\n\t\t}\n\n\t\tlet headers: BareHeaders;\n\n\t\tif (typeof init.headers === 'object' && init.headers !== null) {\n\t\t\tif (init.headers instanceof Headers) {\n\t\t\t\theaders = Object.fromEntries(init.headers);\n\t\t\t} else {\n\t\t\t\theaders = init.headers;\n\t\t\t}\n\t\t} else {\n\t\t\theaders = {};\n\t\t}\n\n\t\tlet cache: BareCache;\n\n\t\tif (typeof init.cache === 'string') {\n\t\t\tcache = init.cache;\n\t\t} else {\n\t\t\tcache = 'default';\n\t\t}\n\n\t\tlet signal: AbortSignal | undefined;\n\n\t\tif (init.signal instanceof AbortSignal) {\n\t\t\tsignal = init.signal;\n\t\t}\n\n\t\tfor (let i = 0; ; i++) {\n\t\t\tlet port;\n\n\t\t\tif (url.port === '') {\n\t\t\t\tif (url.protocol === 'https:') {\n\t\t\t\t\tport = '443';\n\t\t\t\t} else {\n\t\t\t\t\tport = '80';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tport = url.port;\n\t\t\t}\n\n\t\t\theaders.host = url.host;\n\n\t\t\tconst response: BareResponse & Partial<BareResponseFetch> =\n\t\t\t\tawait this.request(\n\t\t\t\t\tmethod,\n\t\t\t\t\theaders,\n\t\t\t\t\tbody,\n\t\t\t\t\turl.protocol,\n\t\t\t\t\turl.hostname,\n\t\t\t\t\tport,\n\t\t\t\t\turl.pathname + url.search,\n\t\t\t\t\tcache,\n\t\t\t\t\tsignal\n\t\t\t\t);\n\n\t\t\tresponse.finalURL = url.toString();\n\n\t\t\tif (statusRedirect.includes(response.status)) {\n\t\t\t\tswitch (init.redirect) {\n\t\t\t\t\tdefault:\n\t\t\t\t\tcase 'follow':\n\t\t\t\t\t\tif (maxRedirects > i && response.headers.has('location')) {\n\t\t\t\t\t\t\turl = new URL(response.headers.get('location')!, url);\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow new TypeError('Failed to fetch');\n\t\t\t\t\t\t}\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\tthrow new TypeError('Failed to fetch');\n\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\treturn <BareResponseFetch>response;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn <BareResponseFetch>response;\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["global","globalThis","fetch","WebSocket","Request","Response","statusEmpty","statusRedirect","BareError","Error","status","body","constructor","message","code","Client","base","version","server","URL","validChars","reserveChar","validProtocol","protocol","i","length","char","includes","encodeProtocol","result","charCodeAt","toString","padStart","ClientV1","ws","http","newMeta","getMeta","connect","requestHeaders","host","port","path","assignMeta","method","ok","json","id","text","socket","JSON","stringify","remote","headers","forward_headers","meta","Promise","resolve","reject","addEventListener","outgoing","request","cache","signal","startsWith","response","location","origin","rawHeaders","Object","fromEntries","rawResponse","bareHeaders","Headers","header","value","forwardHeaders","options","credentials","undefined","writeBareRequest","readResponse","readBareResponse","statusText","requiredHeaders","has","parseInt","get","parse","set","safeAdd","x","y","lsw","msw","bitRotateLeft","num","cnt","md5cmn","q","a","b","s","t","md5ff","c","d","md5gg","md5hh","md5ii","binlMD5","len","olda","oldb","oldc","oldd","binl2rstr","input","output","length32","String","fromCharCode","rstr2binl","outputLen","length8","rstrMD5","rstrHMACMD5","key","data","bkey","ipad","opad","hash","concat","rstr2hex","hexTab","charAt","str2rstrUTF8","unescape","encodeURIComponent","rawMD5","hexMD5","rawHMACMD5","k","hexHMACMD5","md5","string","raw","MAX_HEADER_VALUE","splitHeaders","delete","split","part","slice","joinHeaders","prefix","join","ClientV2","createBareHeaders","assign_meta","responseHeaders","passHeaders","passStatus","append","clientCtors","maxRedirects","BareClient","client","ready","loadData","found","ctor","versions","work","createWebSocket","url","protocols","proto","DOMException","hostname","pathname","search","init","AbortSignal","finalURL","redirect","TypeError"],"mappings":"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"}